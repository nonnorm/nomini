(()=>{const o=(e,t,n)=>{n={bubbles:!0,detail:{},...n},e.dispatchEvent(new CustomEvent(t,n))},i=(e,t,n)=>{/^{.*}$/s.test(e)&&(e=e.slice(1,-1));try{return new Function("__data",`with(__data) {return {${e}}}`).call(n,t)}catch(t){return console.error("[Nomini] failed to parse obj:",e,`
`,t),{}}},n=(e,t)=>{const n=e.matches(t)?[e]:[];return[...n,...e.querySelectorAll(t)].filter(e=>!e.closest("[nm-ignore]"))},a=e=>e.closest("[nm-data]")?.nmProxy||c(),r=t=>{e=t,e(),e=null},s=(e,n)=>{t=e,n(),t=null};let e=null,t=null;const c=()=>({$refs:{},$dataset(){let n={},e=t;for(;e;){if(n={...e.dataset,...n},e.hasAttribute("nm-data"))break;e=e.parentElement}return n},$watch:r,$dispatch(e,n,s){o(t,e,{detail:n,...s})},$debounce(e,n,o=!0){const i=t,a=this._nmAbort.signal;clearTimeout(i.nmTimer),i.nmTimer=setTimeout(()=>{o&&a.aborted||s(i,e)},n)}}),l=t=>{n(t,"[nm-data]").forEach(t=>{const s={...i(t.getAttribute("nm-data"),{},t),...c()},n={},o=new Proxy(s,{get(t,s){return e&&(n[s]||=new Set).add(e),t[s]},set(t,s,o){t[s]=o;const i=n[s];if(i){const t=e;e=null,i.forEach(e=>e()),e=t}return!0}});t.nmProxy=o}),n(t,"[nm-ref]").forEach(e=>{const t=a(e),n=e.getAttribute("nm-ref");t.$refs[n]=e}),n(t,"[nm-bind]").forEach(e=>{const t=a(e),n=i(e.getAttribute("nm-bind"),t,e);Object.entries(n).forEach(([t,n])=>{if(t.startsWith("on")){const[i,...o]=t.slice(2).split("."),a=t=>{s(e,()=>n(t))};(o.includes("window")?window:e).addEventListener(i,a,{once:o.includes("once")})}else{const[o,i]=t.split(".");s(e,()=>r(async()=>{const t=await n();i?o==="class"?e.classList.toggle(i,t):e[o][i]=t:e[o]=t}))}}),o(e,"init",{bubbles:!1})})};document.addEventListener("DOMContentLoaded",()=>l(document.body))})()